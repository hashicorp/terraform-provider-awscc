
---
page_title: "awscc_iot_account_audit_configuration Resource - terraform-provider-awscc"
subcategory: ""
description: |-
  Configures the Device Defender audit settings for this account. Settings include how audit notifications are sent and which audit checks are enabled or disabled.
---

# awscc_iot_account_audit_configuration (Resource)

Configures the Device Defender audit settings for this account. Settings include how audit notifications are sent and which audit checks are enabled or disabled.

## Example Usage

### IoT Device Defender Audit Configuration

Configures AWS IoT Device Defender audit settings with five enabled security checks and creates necessary IAM role with appropriate permissions for IoT audit operations.

~> This example is generated by LLM using Amazon Bedrock and validated using terraform validate, apply and destroy. While we strive for accuracy and quality, please note that the information provided may not be entirely error-free or up-to-date. We recommend independently verifying the content.

```terraform
# Get current account ID
data "aws_caller_identity" "current" {}

# Create IAM role for IoT Device Defender using AWSCC provider
resource "awscc_iam_role" "iot_audit_role" {
  role_name = "IoTDeviceDefenderAuditRole"
  assume_role_policy_document = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Action = "sts:AssumeRole"
        Effect = "Allow"
        Principal = {
          Service = "iot.amazonaws.com"
        }
      }
    ]
  })

  tags = [{
    key   = "Modified By"
    value = "AWSCC"
  }]
}

resource "awscc_iam_role_policy" "iot_audit_policy" {
  policy_name = "IoTDeviceDefenderAuditAccess"
  role_name   = awscc_iam_role.iot_audit_role.role_name

  policy_document = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Effect = "Allow"
        Action = [
          "iot:GetLoggingOptions",
          "iot:GetPolicy",
          "iot:GetCACertificate",
          "iot:ListCACertificates",
          "iot:ListCertificates",
          "iot:GetCertificate",
          "iot:ListRoleAliases",
          "iot:DescribeRoleAlias",
          "iam:GetRole"
        ]
        Resource = "*"
      }
    ]
  })
}

# Create IoT Device Defender audit configuration
resource "awscc_iot_account_audit_configuration" "example" {
  account_id = data.aws_caller_identity.current.account_id
  role_arn   = awscc_iam_role.iot_audit_role.arn

  audit_check_configurations = {
    authenticated_cognito_role_overly_permissive_check = {
      enabled = true
    }
    ca_certificate_expiring_check = {
      enabled = true
    }
    device_certificate_expiring_check = {
      enabled = true
    }
    iot_policy_overly_permissive_check = {
      enabled = true
    }
    logging_disabled_check = {
      enabled = true
    }
  }

  audit_notification_target_configurations = {
    sns = {
      enabled    = false
      role_arn   = null
      target_arn = null
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `account_id` (String) Your 12-digit account ID (used as the primary identifier for the CloudFormation resource).
- `audit_check_configurations` (Attributes) Specifies which audit checks are enabled and disabled for this account. (see [below for nested schema](#nestedatt--audit_check_configurations))
- `role_arn` (String) The ARN of the role that grants permission to AWS IoT to access information about your devices, policies, certificates and other items as required when performing an audit.

### Optional

- `audit_notification_target_configurations` (Attributes) Information about the targets to which audit notifications are sent. (see [below for nested schema](#nestedatt--audit_notification_target_configurations))

### Read-Only

- `id` (String) Uniquely identifies the resource.

<a id="nestedatt--audit_check_configurations"></a>
### Nested Schema for `audit_check_configurations`

Optional:

- `authenticated_cognito_role_overly_permissive_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--authenticated_cognito_role_overly_permissive_check))
- `ca_certificate_expiring_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--ca_certificate_expiring_check))
- `ca_certificate_key_quality_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--ca_certificate_key_quality_check))
- `conflicting_client_ids_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--conflicting_client_ids_check))
- `device_certificate_age_check` (Attributes) A structure containing the configName and corresponding configValue for configuring DeviceCertAgeCheck. (see [below for nested schema](#nestedatt--audit_check_configurations--device_certificate_age_check))
- `device_certificate_expiring_check` (Attributes) A structure containing the configName and corresponding configValue for configuring DeviceCertExpirationCheck. (see [below for nested schema](#nestedatt--audit_check_configurations--device_certificate_expiring_check))
- `device_certificate_key_quality_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--device_certificate_key_quality_check))
- `device_certificate_shared_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--device_certificate_shared_check))
- `intermediate_ca_revoked_for_active_device_certificates_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--intermediate_ca_revoked_for_active_device_certificates_check))
- `io_t_policy_potential_mis_configuration_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--io_t_policy_potential_mis_configuration_check))
- `iot_policy_overly_permissive_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--iot_policy_overly_permissive_check))
- `iot_role_alias_allows_access_to_unused_services_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--iot_role_alias_allows_access_to_unused_services_check))
- `iot_role_alias_overly_permissive_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--iot_role_alias_overly_permissive_check))
- `logging_disabled_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--logging_disabled_check))
- `revoked_ca_certificate_still_active_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--revoked_ca_certificate_still_active_check))
- `revoked_device_certificate_still_active_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--revoked_device_certificate_still_active_check))
- `unauthenticated_cognito_role_overly_permissive_check` (Attributes) The configuration for a specific audit check. (see [below for nested schema](#nestedatt--audit_check_configurations--unauthenticated_cognito_role_overly_permissive_check))

<a id="nestedatt--audit_check_configurations--authenticated_cognito_role_overly_permissive_check"></a>
### Nested Schema for `audit_check_configurations.authenticated_cognito_role_overly_permissive_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--ca_certificate_expiring_check"></a>
### Nested Schema for `audit_check_configurations.ca_certificate_expiring_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--ca_certificate_key_quality_check"></a>
### Nested Schema for `audit_check_configurations.ca_certificate_key_quality_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--conflicting_client_ids_check"></a>
### Nested Schema for `audit_check_configurations.conflicting_client_ids_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--device_certificate_age_check"></a>
### Nested Schema for `audit_check_configurations.device_certificate_age_check`

Optional:

- `configuration` (Attributes) A structure containing the configName and corresponding configValue for configuring audit checks. (see [below for nested schema](#nestedatt--audit_check_configurations--device_certificate_age_check--configuration))
- `enabled` (Boolean) True if the check is enabled.

<a id="nestedatt--audit_check_configurations--device_certificate_age_check--configuration"></a>
### Nested Schema for `audit_check_configurations.device_certificate_age_check.configuration`

Optional:

- `cert_age_threshold_in_days` (String) The configValue for configuring audit checks.



<a id="nestedatt--audit_check_configurations--device_certificate_expiring_check"></a>
### Nested Schema for `audit_check_configurations.device_certificate_expiring_check`

Optional:

- `configuration` (Attributes) A structure containing the configName and corresponding configValue for configuring audit checks. (see [below for nested schema](#nestedatt--audit_check_configurations--device_certificate_expiring_check--configuration))
- `enabled` (Boolean) True if the check is enabled.

<a id="nestedatt--audit_check_configurations--device_certificate_expiring_check--configuration"></a>
### Nested Schema for `audit_check_configurations.device_certificate_expiring_check.configuration`

Optional:

- `cert_expiration_threshold_in_days` (String) The configValue for configuring audit checks.



<a id="nestedatt--audit_check_configurations--device_certificate_key_quality_check"></a>
### Nested Schema for `audit_check_configurations.device_certificate_key_quality_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--device_certificate_shared_check"></a>
### Nested Schema for `audit_check_configurations.device_certificate_shared_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--intermediate_ca_revoked_for_active_device_certificates_check"></a>
### Nested Schema for `audit_check_configurations.intermediate_ca_revoked_for_active_device_certificates_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--io_t_policy_potential_mis_configuration_check"></a>
### Nested Schema for `audit_check_configurations.io_t_policy_potential_mis_configuration_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--iot_policy_overly_permissive_check"></a>
### Nested Schema for `audit_check_configurations.iot_policy_overly_permissive_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--iot_role_alias_allows_access_to_unused_services_check"></a>
### Nested Schema for `audit_check_configurations.iot_role_alias_allows_access_to_unused_services_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--iot_role_alias_overly_permissive_check"></a>
### Nested Schema for `audit_check_configurations.iot_role_alias_overly_permissive_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--logging_disabled_check"></a>
### Nested Schema for `audit_check_configurations.logging_disabled_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--revoked_ca_certificate_still_active_check"></a>
### Nested Schema for `audit_check_configurations.revoked_ca_certificate_still_active_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--revoked_device_certificate_still_active_check"></a>
### Nested Schema for `audit_check_configurations.revoked_device_certificate_still_active_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.


<a id="nestedatt--audit_check_configurations--unauthenticated_cognito_role_overly_permissive_check"></a>
### Nested Schema for `audit_check_configurations.unauthenticated_cognito_role_overly_permissive_check`

Optional:

- `enabled` (Boolean) True if the check is enabled.



<a id="nestedatt--audit_notification_target_configurations"></a>
### Nested Schema for `audit_notification_target_configurations`

Optional:

- `sns` (Attributes) (see [below for nested schema](#nestedatt--audit_notification_target_configurations--sns))

<a id="nestedatt--audit_notification_target_configurations--sns"></a>
### Nested Schema for `audit_notification_target_configurations.sns`

Optional:

- `enabled` (Boolean) True if notifications to the target are enabled.
- `role_arn` (String) The ARN of the role that grants permission to send notifications to the target.
- `target_arn` (String) The ARN of the target (SNS topic) to which audit notifications are sent.

## Import

Import is supported using the following syntax:

In Terraform v1.12.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `identity` attribute, for example:

```terraform
import {
  to = awscc_iot_account_audit_configuration.example
  identity = {
    account_id = "account_id"
  }
}
```

<!-- schema generated by tfplugindocs -->
### Identity Schema


#### Optional

- `account_id` (String) AWS Account where this resource is managed
- `region` (String) Region where this resource is managed

In Terraform v1.5.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `id` attribute, for example:

```terraform
import {
  to = awscc_iot_account_audit_configuration.example
  id = "account_id"
}
```

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
$ terraform import awscc_iot_account_audit_configuration.example "account_id"
```
