
---
page_title: "awscc_fms_policy Resource - terraform-provider-awscc"
subcategory: ""
description: |-
  Creates an AWS Firewall Manager policy.
---

# awscc_fms_policy (Resource)

Creates an AWS Firewall Manager policy.

## Example Usage

### WAF Security Policy with Firewall Manager

Creates an AWS Firewall Manager security policy that applies WAF rules to Application Load Balancers, with a default BLOCK action while counting matches from the default rule group.

~> This example is generated by LLM using Amazon Bedrock and validated using terraform validate, apply and destroy. While we strive for accuracy and quality, please note that the information provided may not be entirely error-free or up-to-date. We recommend independently verifying the content.

```terraform
# Prerequisites:
# 1. AWS Organizations must be enabled for your AWS account
# 2. AWS Firewall Manager must be enabled in your organization
# 3. AWS Firewall Manager administrator account must be designated

# Get current AWS account ID
data "aws_caller_identity" "current" {}

# Example FMS Security Policy
resource "awscc_fms_policy" "example" {
  policy_name           = "example-fms-policy"
  remediation_enabled   = true
  exclude_resource_tags = false

  security_service_policy_data = {
    type = "WAF"
    managed_service_data = jsonencode({
      type = "WAF"
      ruleGroups = [{
        id = "default"
        overrideAction = {
          type = "COUNT"
        }
      }]
      defaultAction = {
        type = "BLOCK"
      }
      overrideCustomerWebACLAssociation = false
    })
  }

  resource_type = "AWS::ElasticLoadBalancingV2::LoadBalancer"

  policy_description = "Example FMS WAF Policy"

  # Example include map - you can include specific accounts or OUs
  include_map = {
    account = [data.aws_caller_identity.current.account_id]
  }

  tags = [{
    key   = "ModifiedBy"
    value = "AWSCC"
  }]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `exclude_resource_tags` (Boolean)
- `policy_name` (String)
- `remediation_enabled` (Boolean)
- `security_service_policy_data` (Attributes) Firewall security service policy data. (see [below for nested schema](#nestedatt--security_service_policy_data))

### Optional

- `delete_all_policy_resources` (Boolean)
- `exclude_map` (Attributes) An FMS includeMap or excludeMap. (see [below for nested schema](#nestedatt--exclude_map))
- `include_map` (Attributes) An FMS includeMap or excludeMap. (see [below for nested schema](#nestedatt--include_map))
- `policy_description` (String)
- `resource_set_ids` (List of String)
- `resource_tag_logical_operator` (String)
- `resource_tags` (Attributes List) (see [below for nested schema](#nestedatt--resource_tags))
- `resource_type` (String) An AWS resource type
- `resource_type_list` (List of String)
- `resources_clean_up` (Boolean)
- `tags` (Attributes List) (see [below for nested schema](#nestedatt--tags))

### Read-Only

- `arn` (String) A resource ARN.
- `id` (String) Uniquely identifies the resource.
- `policy_id` (String)

<a id="nestedatt--security_service_policy_data"></a>
### Nested Schema for `security_service_policy_data`

Required:

- `type` (String) Firewall policy type.

Optional:

- `managed_service_data` (String) Firewall managed service data.
- `policy_option` (Attributes) Firewall policy option. (see [below for nested schema](#nestedatt--security_service_policy_data--policy_option))

<a id="nestedatt--security_service_policy_data--policy_option"></a>
### Nested Schema for `security_service_policy_data.policy_option`

Optional:

- `network_acl_common_policy` (Attributes) Network ACL common policy. (see [below for nested schema](#nestedatt--security_service_policy_data--policy_option--network_acl_common_policy))
- `network_firewall_policy` (Attributes) Network firewall policy. (see [below for nested schema](#nestedatt--security_service_policy_data--policy_option--network_firewall_policy))
- `third_party_firewall_policy` (Attributes) Third party firewall policy. (see [below for nested schema](#nestedatt--security_service_policy_data--policy_option--third_party_firewall_policy))

<a id="nestedatt--security_service_policy_data--policy_option--network_acl_common_policy"></a>
### Nested Schema for `security_service_policy_data.policy_option.network_acl_common_policy`

Optional:

- `network_acl_entry_set` (Attributes) Network ACL entry set. (see [below for nested schema](#nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set))

<a id="nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set"></a>
### Nested Schema for `security_service_policy_data.policy_option.network_acl_common_policy.network_acl_entry_set`

Optional:

- `first_entries` (Attributes List) NetworkAcl entry list. (see [below for nested schema](#nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set--first_entries))
- `force_remediate_for_first_entries` (Boolean)
- `force_remediate_for_last_entries` (Boolean)
- `last_entries` (Attributes List) NetworkAcl entry list. (see [below for nested schema](#nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set--last_entries))

<a id="nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set--first_entries"></a>
### Nested Schema for `security_service_policy_data.policy_option.network_acl_common_policy.network_acl_entry_set.first_entries`

Optional:

- `cidr_block` (String) CIDR block.
- `egress` (Boolean) Whether the entry is an egress entry.
- `icmp_type_code` (Attributes) ICMP type and code. (see [below for nested schema](#nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set--first_entries--icmp_type_code))
- `ipv_6_cidr_block` (String) IPv6 CIDR block.
- `port_range` (Attributes) Port range. (see [below for nested schema](#nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set--first_entries--port_range))
- `protocol` (String) Protocol.
- `rule_action` (String) Rule Action.

<a id="nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set--first_entries--icmp_type_code"></a>
### Nested Schema for `security_service_policy_data.policy_option.network_acl_common_policy.network_acl_entry_set.first_entries.icmp_type_code`

Optional:

- `code` (Number) Code.
- `type` (Number) Type.


<a id="nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set--first_entries--port_range"></a>
### Nested Schema for `security_service_policy_data.policy_option.network_acl_common_policy.network_acl_entry_set.first_entries.port_range`

Optional:

- `from` (Number) From Port.
- `to` (Number) To Port.



<a id="nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set--last_entries"></a>
### Nested Schema for `security_service_policy_data.policy_option.network_acl_common_policy.network_acl_entry_set.last_entries`

Optional:

- `cidr_block` (String) CIDR block.
- `egress` (Boolean) Whether the entry is an egress entry.
- `icmp_type_code` (Attributes) ICMP type and code. (see [below for nested schema](#nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set--last_entries--icmp_type_code))
- `ipv_6_cidr_block` (String) IPv6 CIDR block.
- `port_range` (Attributes) Port range. (see [below for nested schema](#nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set--last_entries--port_range))
- `protocol` (String) Protocol.
- `rule_action` (String) Rule Action.

<a id="nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set--last_entries--icmp_type_code"></a>
### Nested Schema for `security_service_policy_data.policy_option.network_acl_common_policy.network_acl_entry_set.last_entries.icmp_type_code`

Optional:

- `code` (Number) Code.
- `type` (Number) Type.


<a id="nestedatt--security_service_policy_data--policy_option--network_acl_common_policy--network_acl_entry_set--last_entries--port_range"></a>
### Nested Schema for `security_service_policy_data.policy_option.network_acl_common_policy.network_acl_entry_set.last_entries.port_range`

Optional:

- `from` (Number) From Port.
- `to` (Number) To Port.





<a id="nestedatt--security_service_policy_data--policy_option--network_firewall_policy"></a>
### Nested Schema for `security_service_policy_data.policy_option.network_firewall_policy`

Optional:

- `firewall_deployment_model` (String) Firewall deployment mode.


<a id="nestedatt--security_service_policy_data--policy_option--third_party_firewall_policy"></a>
### Nested Schema for `security_service_policy_data.policy_option.third_party_firewall_policy`

Optional:

- `firewall_deployment_model` (String) Firewall deployment mode.




<a id="nestedatt--exclude_map"></a>
### Nested Schema for `exclude_map`

Optional:

- `account` (List of String)
- `orgunit` (List of String)


<a id="nestedatt--include_map"></a>
### Nested Schema for `include_map`

Optional:

- `account` (List of String)
- `orgunit` (List of String)


<a id="nestedatt--resource_tags"></a>
### Nested Schema for `resource_tags`

Optional:

- `key` (String)
- `value` (String)


<a id="nestedatt--tags"></a>
### Nested Schema for `tags`

Optional:

- `key` (String)
- `value` (String)

## Import

Import is supported using the following syntax:

In Terraform v1.12.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `identity` attribute, for example:

```terraform
import {
  to = awscc_fms_policy.example
  identity = {
    id = "id"
  }
}
```

<!-- schema generated by tfplugindocs -->
### Identity Schema

#### Required

- `id` (String)

#### Optional

- `account_id` (String) AWS Account where this resource is managed
- `region` (String) Region where this resource is managed

In Terraform v1.5.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `id` attribute, for example:

```terraform
import {
  to = awscc_fms_policy.example
  id = "id"
}
```

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
$ terraform import awscc_fms_policy.example "id"
```
