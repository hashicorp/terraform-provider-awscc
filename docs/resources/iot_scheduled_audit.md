
---
page_title: "awscc_iot_scheduled_audit Resource - terraform-provider-awscc"
subcategory: ""
description: |-
  Scheduled audits can be used to specify the checks you want to perform during an audit and how often the audit should be run.
---

# awscc_iot_scheduled_audit (Resource)

Scheduled audits can be used to specify the checks you want to perform during an audit and how often the audit should be run.

## Example Usage

### Daily IoT Security Audit Schedule

Creates a daily scheduled IoT audit that performs security checks including Cognito role permissions, certificate expiration, client ID conflicts, and IoT policy permissions, with results published to an SNS topic.

~> This example is generated by LLM using Amazon Bedrock and validated using terraform validate, apply and destroy. While we strive for accuracy and quality, please note that the information provided may not be entirely error-free or up-to-date. We recommend independently verifying the content.

```terraform
data "aws_caller_identity" "current" {}

# First, set up the IoT audit configuration
resource "awscc_iot_account_audit_configuration" "config" {
  account_id = data.aws_caller_identity.current.account_id
  audit_check_configurations = {
    authenticated_cognito_role_overly_permissive_check = {
      enabled = true
    }
    ca_certificate_expiring_check = {
      enabled = true
    }
    conflicting_client_ids_check = {
      enabled = true
    }
    device_certificate_expiring_check = {
      enabled = true
    }
    iot_policy_overly_permissive_check = {
      enabled = true
    }
  }
  audit_notification_target_configurations = {
    sns = {
      enabled    = true
      role_arn   = awscc_iam_role.audit_notification.arn
      target_arn = awscc_sns_topic.audit_notifications.topic_arn
    }
  }
  role_arn = awscc_iam_role.audit_role.arn
}

# SNS topic for audit notifications
resource "awscc_sns_topic" "audit_notifications" {
  topic_name = "iot-audit-notifications"
  tags = [{
    key   = "Modified By"
    value = "AWSCC"
  }]
}

# IAM role for IoT audit
resource "awscc_iam_role" "audit_role" {
  role_name = "iot-audit-role"
  assume_role_policy_document = jsonencode({
    Version = "2012-10-17"
    Statement = [{
      Action = "sts:AssumeRole"
      Effect = "Allow"
      Principal = {
        Service = "iot.amazonaws.com"
      }
    }]
  })
  tags = [{
    key   = "Modified By"
    value = "AWSCC"
  }]
}

# Policy for IoT audit role
resource "awscc_iam_role_policy" "audit_policy" {
  policy_name = "iot-audit-policy"
  role_name   = awscc_iam_role.audit_role.role_name
  policy_document = jsonencode({
    Version = "2012-10-17"
    Statement = [{
      Effect = "Allow"
      Action = [
        "iot:GetLoggingOptions",
        "iot:GetPolicy",
        "iot:GetPolicy*",
        "iot:ListCertificates",
        "iot:ListPolicies",
        "iot:ListThings",
        "iot:DescribeCertificate",
        "iot:DescribeRoleAlias",
        "iot:GetEffectivePolicies",
        "iot:ListRoleAliases",
        "iot:ListTargetsForPolicy",
        "iot:ListPrincipalThings",
        "iot:ListPolicyVersions",
        "iot:ListThingsInBillingGroup",
        "iot:ListThingsInThingGroup",
        "iot:ListAttachedPolicies",
        "iot:ListCertificatesByCA",
        "iot:ListIndicesForPolicy",
        "iot:ListPrincipalPolicies",
        "iot:ValidateSecurityProfileBehaviors"
      ]
      Resource = "*"
    }]
  })
}

# IAM role for audit notifications
resource "awscc_iam_role" "audit_notification" {
  role_name = "iot-audit-notification-role"
  assume_role_policy_document = jsonencode({
    Version = "2012-10-17"
    Statement = [{
      Action = "sts:AssumeRole"
      Effect = "Allow"
      Principal = {
        Service = "iot.amazonaws.com"
      }
    }]
  })
  tags = [{
    key   = "Modified By"
    value = "AWSCC"
  }]
}

# Create the scheduled audit
resource "awscc_iot_scheduled_audit" "example" {
  depends_on = [awscc_iot_account_audit_configuration.config]
  frequency  = "DAILY"
  target_check_names = [
    "AUTHENTICATED_COGNITO_ROLE_OVERLY_PERMISSIVE_CHECK",
    "CA_CERTIFICATE_EXPIRING_CHECK",
    "CONFLICTING_CLIENT_IDS_CHECK",
    "DEVICE_CERTIFICATE_EXPIRING_CHECK",
    "IOT_POLICY_OVERLY_PERMISSIVE_CHECK"
  ]
  scheduled_audit_name = "example-scheduled-audit"
  tags = [{
    key   = "Modified By"
    value = "AWSCC"
  }]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `frequency` (String) How often the scheduled audit takes place. Can be one of DAILY, WEEKLY, BIWEEKLY, or MONTHLY.
- `target_check_names` (Set of String) Which checks are performed during the scheduled audit. Checks must be enabled for your account.

### Optional

- `day_of_month` (String) The day of the month on which the scheduled audit takes place. Can be 1 through 31 or LAST. This field is required if the frequency parameter is set to MONTHLY.
- `day_of_week` (String) The day of the week on which the scheduled audit takes place. Can be one of SUN, MON, TUE,WED, THU, FRI, or SAT. This field is required if the frequency parameter is set to WEEKLY or BIWEEKLY.
- `scheduled_audit_name` (String) The name you want to give to the scheduled audit.
- `tags` (Attributes Set) An array of key-value pairs to apply to this resource. (see [below for nested schema](#nestedatt--tags))

### Read-Only

- `id` (String) Uniquely identifies the resource.
- `scheduled_audit_arn` (String) The ARN (Amazon resource name) of the scheduled audit.

<a id="nestedatt--tags"></a>
### Nested Schema for `tags`

Optional:

- `key` (String) The tag's key.
- `value` (String) The tag's value.

## Import

Import is supported using the following syntax:

In Terraform v1.12.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `identity` attribute, for example:

```terraform
import {
  to = awscc_iot_scheduled_audit.example
  identity = {
    scheduled_audit_name = "scheduled_audit_name"
  }
}
```

<!-- schema generated by tfplugindocs -->
### Identity Schema

#### Required

- `scheduled_audit_name` (String) The name you want to give to the scheduled audit

#### Optional

- `account_id` (String) The ID of the AWS account
- `region` (String) The AWS region where the resource is located

In Terraform v1.5.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `id` attribute, for example:

```terraform
import {
  to = awscc_iot_scheduled_audit.example
  id = "scheduled_audit_name"
}
```

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
$ terraform import awscc_iot_scheduled_audit.example "scheduled_audit_name"
```
