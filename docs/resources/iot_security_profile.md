
---
page_title: "awscc_iot_security_profile Resource - terraform-provider-awscc"
subcategory: ""
description: |-
  A security profile defines a set of expected behaviors for devices in your account.
---

# awscc_iot_security_profile (Resource)

A security profile defines a set of expected behaviors for devices in your account.

## Example Usage

### IoT Security Profile with Behavior Monitoring

Creates an IoT security profile that monitors device behaviors including message sizes and authorization failures, with alerts sent to an SNS topic when thresholds are exceeded.

~> This example is generated by LLM using Amazon Bedrock and validated using terraform validate, apply and destroy. While we strive for accuracy and quality, please note that the information provided may not be entirely error-free or up-to-date. We recommend independently verifying the content.

```terraform
# SNS Topic for alerts
resource "awscc_sns_topic" "iot_alerts" {
  topic_name = "iot-security-alerts"
  tags = [{
    key   = "Modified By"
    value = "AWSCC"
  }]
}

# IAM role for security profile alerts
resource "awscc_iam_role" "iot_security_alerts" {
  role_name = "iot-security-alerts-role"
  assume_role_policy_document = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Action = "sts:AssumeRole"
        Effect = "Allow"
        Principal = {
          Service = "iot.amazonaws.com"
        }
      }
    ]
  })
  policies = [{
    policy_name = "IoTSecurityAlertsPolicy"
    policy_document = jsonencode({
      Version = "2012-10-17"
      Statement = [
        {
          Effect = "Allow"
          Action = [
            "sns:Publish"
          ]
          Resource = [awscc_sns_topic.iot_alerts.topic_arn]
        }
      ]
    })
  }]
  tags = [{
    key   = "Modified By"
    value = "AWSCC"
  }]
}

# IoT Security Profile
resource "awscc_iot_security_profile" "example" {
  security_profile_name        = "example-security-profile"
  security_profile_description = "Example IoT Security Profile"

  behaviors = [
    {
      name   = "num-messages-sent"
      metric = "aws:message-byte-size"
      criteria = {
        consecutive_datapoints_to_alarm = 1
        consecutive_datapoints_to_clear = 1
        comparison_operator             = "greater-than"
        value = {
          count = "50"
        }
      }
    },
    {
      name   = "auth-failures"
      metric = "aws:num-authorization-failures"
      criteria = {
        consecutive_datapoints_to_alarm = 1
        consecutive_datapoints_to_clear = 1
        comparison_operator             = "greater-than"
        duration_seconds                = 300
        value = {
          count = "10"
        }
      }
    }
  ]

  alert_targets = {
    "SNS" = {
      alert_target_arn = awscc_sns_topic.iot_alerts.topic_arn
      role_arn         = awscc_iam_role.iot_security_alerts.arn
    }
  }

  additional_metrics_to_retain_v2 = [
    {
      metric = "aws:message-byte-size"
    }
  ]

  tags = [{
    key   = "Modified By"
    value = "AWSCC"
  }]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `additional_metrics_to_retain_v2` (Attributes Set) A list of metrics whose data is retained (stored). By default, data is retained for any metric used in the profile's behaviors, but it is also retained for any metric specified here. (see [below for nested schema](#nestedatt--additional_metrics_to_retain_v2))
- `alert_targets` (Attributes Map) Specifies the destinations to which alerts are sent. (see [below for nested schema](#nestedatt--alert_targets))
- `behaviors` (Attributes Set) Specifies the behaviors that, when violated by a device (thing), cause an alert. (see [below for nested schema](#nestedatt--behaviors))
- `metrics_export_config` (Attributes) A structure containing the mqtt topic for metrics export. (see [below for nested schema](#nestedatt--metrics_export_config))
- `security_profile_description` (String) A description of the security profile.
- `security_profile_name` (String) A unique identifier for the security profile.
- `tags` (Attributes Set) Metadata that can be used to manage the security profile. (see [below for nested schema](#nestedatt--tags))
- `target_arns` (Set of String) A set of target ARNs that the security profile is attached to.

### Read-Only

- `id` (String) Uniquely identifies the resource.
- `security_profile_arn` (String) The ARN (Amazon resource name) of the created security profile.

<a id="nestedatt--additional_metrics_to_retain_v2"></a>
### Nested Schema for `additional_metrics_to_retain_v2`

Optional:

- `export_metric` (Boolean) Flag to enable/disable metrics export for metric to be retained.
- `metric` (String) What is measured by the behavior.
- `metric_dimension` (Attributes) The dimension of a metric. (see [below for nested schema](#nestedatt--additional_metrics_to_retain_v2--metric_dimension))

<a id="nestedatt--additional_metrics_to_retain_v2--metric_dimension"></a>
### Nested Schema for `additional_metrics_to_retain_v2.metric_dimension`

Optional:

- `dimension_name` (String) A unique identifier for the dimension.
- `operator` (String) Defines how the dimensionValues of a dimension are interpreted.



<a id="nestedatt--alert_targets"></a>
### Nested Schema for `alert_targets`

Optional:

- `alert_target_arn` (String) The ARN of the notification target to which alerts are sent.
- `role_arn` (String) The ARN of the role that grants permission to send alerts to the notification target.


<a id="nestedatt--behaviors"></a>
### Nested Schema for `behaviors`

Optional:

- `criteria` (Attributes) The criteria by which the behavior is determined to be normal. (see [below for nested schema](#nestedatt--behaviors--criteria))
- `export_metric` (Boolean) Flag to enable/disable metrics export for metric to be retained.
- `metric` (String) What is measured by the behavior.
- `metric_dimension` (Attributes) The dimension of a metric. (see [below for nested schema](#nestedatt--behaviors--metric_dimension))
- `name` (String) The name for the behavior.
- `suppress_alerts` (Boolean) Manage Detect alarm SNS notifications by setting behavior notification to on or suppressed. Detect will continue to performing device behavior evaluations. However, suppressed alarms wouldn't be forwarded for SNS notification.

<a id="nestedatt--behaviors--criteria"></a>
### Nested Schema for `behaviors.criteria`

Optional:

- `comparison_operator` (String) The operator that relates the thing measured (metric) to the criteria (containing a value or statisticalThreshold).
- `consecutive_datapoints_to_alarm` (Number) If a device is in violation of the behavior for the specified number of consecutive datapoints, an alarm occurs. If not specified, the default is 1.
- `consecutive_datapoints_to_clear` (Number) If an alarm has occurred and the offending device is no longer in violation of the behavior for the specified number of consecutive datapoints, the alarm is cleared. If not specified, the default is 1.
- `duration_seconds` (Number) Use this to specify the time duration over which the behavior is evaluated.
- `ml_detection_config` (Attributes) The configuration of an ML Detect Security Profile. (see [below for nested schema](#nestedatt--behaviors--criteria--ml_detection_config))
- `statistical_threshold` (Attributes) A statistical ranking (percentile) which indicates a threshold value by which a behavior is determined to be in compliance or in violation of the behavior. (see [below for nested schema](#nestedatt--behaviors--criteria--statistical_threshold))
- `value` (Attributes) The value to be compared with the metric. (see [below for nested schema](#nestedatt--behaviors--criteria--value))

<a id="nestedatt--behaviors--criteria--ml_detection_config"></a>
### Nested Schema for `behaviors.criteria.ml_detection_config`

Optional:

- `confidence_level` (String) The sensitivity of anomalous behavior evaluation. Can be Low, Medium, or High.


<a id="nestedatt--behaviors--criteria--statistical_threshold"></a>
### Nested Schema for `behaviors.criteria.statistical_threshold`

Optional:

- `statistic` (String) The percentile which resolves to a threshold value by which compliance with a behavior is determined


<a id="nestedatt--behaviors--criteria--value"></a>
### Nested Schema for `behaviors.criteria.value`

Optional:

- `cidrs` (Set of String) If the ComparisonOperator calls for a set of CIDRs, use this to specify that set to be compared with the metric.
- `count` (String) If the ComparisonOperator calls for a numeric value, use this to specify that (integer) numeric value to be compared with the metric.
- `number` (Number) The numeral value of a metric.
- `numbers` (Set of Number) The numeral values of a metric.
- `ports` (Set of Number) If the ComparisonOperator calls for a set of ports, use this to specify that set to be compared with the metric.
- `strings` (Set of String) The string values of a metric.



<a id="nestedatt--behaviors--metric_dimension"></a>
### Nested Schema for `behaviors.metric_dimension`

Optional:

- `dimension_name` (String) A unique identifier for the dimension.
- `operator` (String) Defines how the dimensionValues of a dimension are interpreted.



<a id="nestedatt--metrics_export_config"></a>
### Nested Schema for `metrics_export_config`

Optional:

- `mqtt_topic` (String) The topic for metrics export.
- `role_arn` (String) The ARN of the role that grants permission to publish to mqtt topic.


<a id="nestedatt--tags"></a>
### Nested Schema for `tags`

Optional:

- `key` (String) The tag's key.
- `value` (String) The tag's value.

## Import

Import is supported using the following syntax:

In Terraform v1.12.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `identity` attribute, for example:

```terraform
import {
  to = awscc_iot_security_profile.example
  identity = {
    security_profile_name = "security_profile_name"
  }
}
```

<!-- schema generated by tfplugindocs -->
### Identity Schema

#### Required

- `security_profile_name` (String) A unique identifier for the security profile

#### Optional

- `account_id` (String) AWS Account where this resource is managed
- `region` (String) Region where this resource is managed

In Terraform v1.5.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `id` attribute, for example:

```terraform
import {
  to = awscc_iot_security_profile.example
  id = "security_profile_name"
}
```

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
$ terraform import awscc_iot_security_profile.example "security_profile_name"
```
