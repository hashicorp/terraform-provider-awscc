
---
page_title: "awscc_iot_fleet_metric Resource - terraform-provider-awscc"
subcategory: ""
description: |-
  An aggregated metric of certain devices in your fleet
---

# awscc_iot_fleet_metric (Resource)

An aggregated metric of certain devices in your fleet

## Example Usage

### IoT Fleet Metric for Device Connectivity

Creates an IoT Fleet Metric that tracks device connectivity status by querying the AWS Things index every 5 minutes, requiring IoT Fleet Indexing to be enabled first.

~> This example is generated by LLM using Amazon Bedrock and validated using terraform validate, apply and destroy. While we strive for accuracy and quality, please note that the information provided may not be entirely error-free or up-to-date. We recommend independently verifying the content.

```terraform
# Enable IoT Fleet Indexing
resource "aws_iot_indexing_configuration" "example" {
  thing_indexing_configuration {
    thing_connectivity_indexing_mode = "STATUS"
    thing_indexing_mode              = "REGISTRY_AND_SHADOW"
  }
}

# Add a time delay for indexing to complete
resource "time_sleep" "wait_60_seconds" {
  depends_on      = [aws_iot_indexing_configuration.example]
  create_duration = "60s"
}

# Create an IoT Fleet Metric
resource "awscc_iot_fleet_metric" "example" {
  depends_on        = [time_sleep.wait_60_seconds]
  metric_name       = "device-connectivity-metric"
  description       = "Fleet metric to track device connectivity status"
  index_name        = "AWS_Things"
  query_string      = "connectivity.connected:true"
  query_version     = "2017-09-30"
  aggregation_field = "connectivity.connected"
  period            = 300 # 5 minutes

  aggregation_type = {
    name = "Statistics"
    values = [
      "count"
    ]
  }

  unit = "Count"

  tags = [{
    key   = "Modified By"
    value = "AWSCC"
  }]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `metric_name` (String) The name of the fleet metric

### Optional

- `aggregation_field` (String) The aggregation field to perform aggregation and metric emission
- `aggregation_type` (Attributes) Aggregation types supported by Fleet Indexing (see [below for nested schema](#nestedatt--aggregation_type))
- `description` (String) The description of a fleet metric
- `index_name` (String) The index name of a fleet metric
- `period` (Number) The period of metric emission in seconds
- `query_string` (String) The Fleet Indexing query used by a fleet metric
- `query_version` (String) The version of a Fleet Indexing query used by a fleet metric
- `tags` (Attributes Set) An array of key-value pairs to apply to this resource (see [below for nested schema](#nestedatt--tags))
- `unit` (String) The unit of data points emitted by a fleet metric

### Read-Only

- `creation_date` (String) The creation date of a fleet metric
- `id` (String) Uniquely identifies the resource.
- `last_modified_date` (String) The last modified date of a fleet metric
- `metric_arn` (String) The Amazon Resource Number (ARN) of a fleet metric metric
- `version` (Number) The version of a fleet metric

<a id="nestedatt--aggregation_type"></a>
### Nested Schema for `aggregation_type`

Optional:

- `name` (String) Fleet Indexing aggregation type names such as Statistics, Percentiles and Cardinality
- `values` (List of String) Fleet Indexing aggregation type values


<a id="nestedatt--tags"></a>
### Nested Schema for `tags`

Optional:

- `key` (String) The tag's key
- `value` (String) The tag's value

## Import

Import is supported using the following syntax:

In Terraform v1.5.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `id` attribute, for example:

```terraform
import {
  to = awscc_iot_fleet_metric.example
  id = "metric_name"
}
```

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
$ terraform import awscc_iot_fleet_metric.example "metric_name"
```
