---
page_title: "awscc_guardduty_detector Resource - terraform-provider-awscc"
subcategory: ""
description: |-
  Resource Type definition for AWS::GuardDuty::Detector
---

# awscc_guardduty_detector (Resource)

Resource Type definition for AWS::GuardDuty::Detector

> [!WARNING] 
>Deleting this resource is equivalent to "disabling" GuardDuty for an AWS region, which removes all existing findings. You can set the enable attribute to false to instead "suspend" monitoring and feedback reporting while keeping existing data. See the [Suspending or Disabling Amazon GuardDuty documentation](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty_suspend-disable.html) for more information.

## Example Usage

The datasources block is deprecated since March 2023. Use the features block instead and [map each datasources block to the corresponding features](https://docs.aws.amazon.com/guardduty/latest/ug/guardduty-feature-object-api-changes-march2023.html#guardduty-feature-enablement-datasource-relation) block.

```terraform
resource "awscc_guardduty_detector" "example" {
  enable = true

  features = [
    {
      name   = "S3_DATA_EVENTS"
      status = "ENABLED"
    },
    {
      name   = "EBS_MALWARE_PROTECTION"
      status = "ENABLED"
    },
    {
      name   = "EKS_AUDIT_LOGS"
      status = "DISABLED"
    }
  ]

  tags = [{
    key   = "Modified By"
    value = "AWSCC"
  }]
}
```


<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `enable` (Boolean)

### Optional

- `data_sources` (Attributes) (see [below for nested schema](#nestedatt--data_sources))
- `features` (Attributes List) (see [below for nested schema](#nestedatt--features))
- `finding_publishing_frequency` (String)
- `tags` (Attributes List) (see [below for nested schema](#nestedatt--tags))

### Read-Only

- `detector_id` (String)
- `id` (String) Uniquely identifies the resource.

<a id="nestedatt--data_sources"></a>
### Nested Schema for `data_sources`

Optional:

- `kubernetes` (Attributes) (see [below for nested schema](#nestedatt--data_sources--kubernetes))
- `malware_protection` (Attributes) (see [below for nested schema](#nestedatt--data_sources--malware_protection))
- `s3_logs` (Attributes) (see [below for nested schema](#nestedatt--data_sources--s3_logs))

<a id="nestedatt--data_sources--kubernetes"></a>
### Nested Schema for `data_sources.kubernetes`

Optional:

- `audit_logs` (Attributes) (see [below for nested schema](#nestedatt--data_sources--kubernetes--audit_logs))

<a id="nestedatt--data_sources--kubernetes--audit_logs"></a>
### Nested Schema for `data_sources.kubernetes.audit_logs`

Optional:

- `enable` (Boolean)



<a id="nestedatt--data_sources--malware_protection"></a>
### Nested Schema for `data_sources.malware_protection`

Optional:

- `scan_ec_2_instance_with_findings` (Attributes) (see [below for nested schema](#nestedatt--data_sources--malware_protection--scan_ec_2_instance_with_findings))

<a id="nestedatt--data_sources--malware_protection--scan_ec_2_instance_with_findings"></a>
### Nested Schema for `data_sources.malware_protection.scan_ec_2_instance_with_findings`

Optional:

- `ebs_volumes` (Boolean)



<a id="nestedatt--data_sources--s3_logs"></a>
### Nested Schema for `data_sources.s3_logs`

Optional:

- `enable` (Boolean)



<a id="nestedatt--features"></a>
### Nested Schema for `features`

Optional:

- `additional_configuration` (Attributes List) (see [below for nested schema](#nestedatt--features--additional_configuration))
- `name` (String)
- `status` (String)

<a id="nestedatt--features--additional_configuration"></a>
### Nested Schema for `features.additional_configuration`

Optional:

- `name` (String)
- `status` (String)



<a id="nestedatt--tags"></a>
### Nested Schema for `tags`

Optional:

- `key` (String)
- `value` (String)

## Import

Import is supported using the following syntax:

In Terraform v1.12.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `identity` attribute, for example:

```terraform
import {
  to = awscc_guardduty_detector.example
  identity = {
    id = "id"
  }
}
```

<!-- schema generated by tfplugindocs -->
### Identity Schema

#### Required

- `id` (String)

#### Optional

- `account_id` (String) AWS Account where this resource is managed
- `region` (String) Region where this resource is managed

In Terraform v1.5.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `id` attribute, for example:

```terraform
import {
  to = awscc_guardduty_detector.example
  id = "id"
}
```

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
$ terraform import awscc_guardduty_detector.example "id"
```