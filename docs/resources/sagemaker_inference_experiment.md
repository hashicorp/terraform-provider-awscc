
---
page_title: "awscc_sagemaker_inference_experiment Resource - terraform-provider-awscc"
subcategory: ""
description: |-
  Resource Type definition for AWS::SageMaker::InferenceExperiment
---

# awscc_sagemaker_inference_experiment (Resource)

Resource Type definition for AWS::SageMaker::InferenceExperiment

## Example Usage

### SageMaker Shadow Mode Inference Experiment

Creates a SageMaker shadow mode inference experiment with supporting IAM role and S3 bucket, enabling model variant comparison by routing 10% of the traffic to a shadow variant while maintaining the original model endpoint.

~> This example is generated by LLM using Amazon Bedrock and validated using terraform validate, apply and destroy. While we strive for accuracy and quality, please note that the information provided may not be entirely error-free or up-to-date. We recommend independently verifying the content.

```terraform
# Data sources to get current AWS account ID and region
data "aws_caller_identity" "current" {}
# Note: Using data.aws_region.current.region (AWS provider v6.0+)
# For AWS provider < v6.0, use data.aws_region.current.name instead
data "aws_region" "current" {}

# IAM Role for SageMaker Inference Experiment
data "aws_iam_policy_document" "assume_role" {
  statement {
    actions = ["sts:AssumeRole"]
    effect  = "Allow"
    principals {
      type        = "Service"
      identifiers = ["sagemaker.amazonaws.com"]
    }
  }
}

data "aws_iam_policy_document" "sagemaker_inference_experiment" {
  statement {
    effect = "Allow"
    actions = [
      "sagemaker:*",
      "s3:GetObject",
      "s3:PutObject",
      "s3:ListBucket",
      "logs:CreateLogGroup",
      "logs:CreateLogStream",
      "logs:PutLogEvents"
    ]
    resources = ["*"]
  }
}

resource "awscc_iam_role" "sagemaker_role" {
  assume_role_policy_document = data.aws_iam_policy_document.assume_role.json
  description                 = "Role for SageMaker Inference Experiment"
  managed_policy_arns         = ["arn:aws:iam::aws:policy/AmazonSageMakerFullAccess"]
  max_session_duration        = 3600
  path                        = "/"
  policies = [{
    policy_document = data.aws_iam_policy_document.sagemaker_inference_experiment.json
    policy_name     = "SageMakerInferenceExperimentPolicy"
  }]
  role_name = "SageMakerInferenceExperimentRole"
  tags = [{
    key   = "Modified By"
    value = "AWSCC"
  }]
}

# S3 Bucket for inference data storage
resource "awscc_s3_bucket" "inference_data" {
  bucket_name = "inference-data-${data.aws_caller_identity.current.account_id}-${data.aws_region.current.region}"

  tags = [{
    key   = "Modified By"
    value = "AWSCC"
  }]
}

# SageMaker Inference Experiment
resource "awscc_sagemaker_inference_experiment" "example" {
  name          = "sample-inference-experiment"
  endpoint_name = "existing-endpoint" # Replace with your existing endpoint name
  type          = "ShadowMode"
  role_arn      = awscc_iam_role.sagemaker_role.arn

  model_variants = [
    {
      model_name   = "existing-model" # Replace with your existing model name
      variant_name = "variant-1"
      infrastructure_config = {
        infrastructure_type = "RealTimeInference"
        real_time_inference_config = {
          instance_count = 1
          instance_type  = "ml.t2.medium"
        }
      }
    }
  ]

  shadow_mode_config = {
    source_model_variant_name = "variant-1"
    shadow_model_variants = [
      {
        shadow_model_variant_name = "shadow-variant-1"
        sampling_percentage       = 10
      }
    ]
  }

  data_storage_config = {
    destination = "s3://${awscc_s3_bucket.inference_data.bucket_name}/inference-data/"
    content_type = {
      json_content_types = ["application/json"]
      csv_content_types  = ["text/csv"]
    }
  }

  description = "Sample inference experiment for testing"

  tags = [{
    key   = "Modified By"
    value = "AWSCC"
  }]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `endpoint_name` (String) The name of the endpoint used to run the inference experiment.
- `model_variants` (Attributes List) An array of ModelVariantConfig objects. Each ModelVariantConfig object in the array describes the infrastructure configuration for the corresponding variant. (see [below for nested schema](#nestedatt--model_variants))
- `name` (String) The name for the inference experiment.
- `role_arn` (String) The Amazon Resource Name (ARN) of an IAM role that Amazon SageMaker can assume to access model artifacts and container images, and manage Amazon SageMaker Inference endpoints for model deployment.
- `type` (String) The type of the inference experiment that you want to run.

### Optional

- `data_storage_config` (Attributes) The Amazon S3 location and configuration for storing inference request and response data. (see [below for nested schema](#nestedatt--data_storage_config))
- `description` (String) The description of the inference experiment.
- `desired_state` (String) The desired state of the experiment after starting or stopping operation.
- `kms_key` (String) The AWS Key Management Service (AWS KMS) key that Amazon SageMaker uses to encrypt data on the storage volume attached to the ML compute instance that hosts the endpoint.
- `schedule` (Attributes) The duration for which you want the inference experiment to run. (see [below for nested schema](#nestedatt--schedule))
- `shadow_mode_config` (Attributes) The configuration of ShadowMode inference experiment type. Use this field to specify a production variant which takes all the inference requests, and a shadow variant to which Amazon SageMaker replicates a percentage of the inference requests. For the shadow variant also specify the percentage of requests that Amazon SageMaker replicates. (see [below for nested schema](#nestedatt--shadow_mode_config))
- `status_reason` (String) The error message or client-specified reason from the StopInferenceExperiment API, that explains the status of the inference experiment.
- `tags` (Attributes List) An array of key-value pairs to apply to this resource. (see [below for nested schema](#nestedatt--tags))

### Read-Only

- `arn` (String) The Amazon Resource Name (ARN) of the inference experiment.
- `creation_time` (String) The timestamp at which you created the inference experiment.
- `endpoint_metadata` (Attributes) The metadata of the endpoint on which the inference experiment ran. (see [below for nested schema](#nestedatt--endpoint_metadata))
- `id` (String) Uniquely identifies the resource.
- `last_modified_time` (String) The timestamp at which you last modified the inference experiment.
- `status` (String) The status of the inference experiment.

<a id="nestedatt--model_variants"></a>
### Nested Schema for `model_variants`

Required:

- `infrastructure_config` (Attributes) The configuration for the infrastructure that the model will be deployed to. (see [below for nested schema](#nestedatt--model_variants--infrastructure_config))
- `model_name` (String) The name of the Amazon SageMaker Model entity.
- `variant_name` (String) The name of the variant.

<a id="nestedatt--model_variants--infrastructure_config"></a>
### Nested Schema for `model_variants.infrastructure_config`

Required:

- `infrastructure_type` (String) The type of the inference experiment that you want to run.
- `real_time_inference_config` (Attributes) The infrastructure configuration for deploying the model to a real-time inference endpoint. (see [below for nested schema](#nestedatt--model_variants--infrastructure_config--real_time_inference_config))

<a id="nestedatt--model_variants--infrastructure_config--real_time_inference_config"></a>
### Nested Schema for `model_variants.infrastructure_config.real_time_inference_config`

Required:

- `instance_count` (Number) The number of instances of the type specified by InstanceType.
- `instance_type` (String) The instance type the model is deployed to.




<a id="nestedatt--data_storage_config"></a>
### Nested Schema for `data_storage_config`

Optional:

- `content_type` (Attributes) Configuration specifying how to treat different headers. If no headers are specified SageMaker will by default base64 encode when capturing the data. (see [below for nested schema](#nestedatt--data_storage_config--content_type))
- `destination` (String) The Amazon S3 bucket where the inference request and response data is stored.
- `kms_key` (String) The AWS Key Management Service key that Amazon SageMaker uses to encrypt captured data at rest using Amazon S3 server-side encryption.

<a id="nestedatt--data_storage_config--content_type"></a>
### Nested Schema for `data_storage_config.content_type`

Optional:

- `csv_content_types` (List of String) The list of all content type headers that SageMaker will treat as CSV and capture accordingly.
- `json_content_types` (List of String) The list of all content type headers that SageMaker will treat as JSON and capture accordingly.



<a id="nestedatt--schedule"></a>
### Nested Schema for `schedule`

Optional:

- `end_time` (String) The timestamp at which the inference experiment ended or will end.
- `start_time` (String) The timestamp at which the inference experiment started or will start.


<a id="nestedatt--shadow_mode_config"></a>
### Nested Schema for `shadow_mode_config`

Optional:

- `shadow_model_variants` (Attributes List) List of shadow variant configurations. (see [below for nested schema](#nestedatt--shadow_mode_config--shadow_model_variants))
- `source_model_variant_name` (String) The name of the production variant, which takes all the inference requests.

<a id="nestedatt--shadow_mode_config--shadow_model_variants"></a>
### Nested Schema for `shadow_mode_config.shadow_model_variants`

Optional:

- `sampling_percentage` (Number) The percentage of inference requests that Amazon SageMaker replicates from the production variant to the shadow variant.
- `shadow_model_variant_name` (String) The name of the shadow variant.



<a id="nestedatt--tags"></a>
### Nested Schema for `tags`

Optional:

- `key` (String) The key name of the tag. You can specify a value that is 1 to 127 Unicode characters in length and cannot be prefixed with aws:. You can use any of the following characters: the set of Unicode letters, digits, whitespace, _, ., /, =, +, and -.
- `value` (String) The value for the tag. You can specify a value that is 1 to 255 Unicode characters in length and cannot be prefixed with aws:. You can use any of the following characters: the set of Unicode letters, digits, whitespace, _, ., /, =, +, and -.


<a id="nestedatt--endpoint_metadata"></a>
### Nested Schema for `endpoint_metadata`

Read-Only:

- `endpoint_config_name` (String) The name of the endpoint configuration.
- `endpoint_name` (String) The name of the endpoint used to run the inference experiment.
- `endpoint_status` (String) The status of the endpoint. For possible values of the status of an endpoint.

## Import

Import is supported using the following syntax:

```shell
$ terraform import awscc_sagemaker_inference_experiment.example "name"
```
