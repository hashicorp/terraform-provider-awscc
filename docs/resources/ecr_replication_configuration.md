
---
page_title: "awscc_ecr_replication_configuration Resource - terraform-provider-awscc"
subcategory: ""
description: |-
  The AWS::ECR::ReplicationConfiguration resource creates or updates the replication configuration for a private registry. The first time a replication configuration is applied to a private registry, a service-linked IAM role is created in your account for the replication process. For more information, see Using Service-Linked Roles for Amazon ECR https://docs.aws.amazon.com/AmazonECR/latest/userguide/using-service-linked-roles.html in the Amazon Elastic Container Registry User Guide.
  When configuring cross-account replication, the destination account must grant the source account permission to replicate. This permission is controlled using a private registry permissions policy. For more information, see AWS::ECR::RegistryPolicy.
---

# awscc_ecr_replication_configuration (Resource)

The ``AWS::ECR::ReplicationConfiguration`` resource creates or updates the replication configuration for a private registry. The first time a replication configuration is applied to a private registry, a service-linked IAM role is created in your account for the replication process. For more information, see [Using Service-Linked Roles for Amazon ECR](https://docs.aws.amazon.com/AmazonECR/latest/userguide/using-service-linked-roles.html) in the *Amazon Elastic Container Registry User Guide*.
  When configuring cross-account replication, the destination account must grant the source account permission to replicate. This permission is controlled using a private registry permissions policy. For more information, see ``AWS::ECR::RegistryPolicy``.

## Example Usage

### Cross-Region ECR Repository Replication

Configure ECR repository replication across multiple AWS regions for repositories with 'prod-' prefix, enabling image replication to two destination regions for enhanced availability and disaster recovery.

~> This example is generated by LLM using Amazon Bedrock and validated using terraform validate, apply and destroy. While we strive for accuracy and quality, please note that the information provided may not be entirely error-free or up-to-date. We recommend independently verifying the content.

```terraform
# Get current AWS account and region
data "aws_caller_identity" "current" {}
data "aws_region" "current" {}

# Create cross region replication configuration
resource "awscc_ecr_replication_configuration" "example" {
  replication_configuration = {
    rules = [
      {
        destinations = [
          {
            region      = (data.aws_region.current.name == "eu-west-1" ? "us-west-2" : "eu-west-1") # Primary replication region
            registry_id = data.aws_caller_identity.current.account_id
          },
          {
            region      = "ap-southeast-1" # Secondary replication region
            registry_id = data.aws_caller_identity.current.account_id
          }
        ]
        repository_filters = [
          {
            filter      = "prod-"
            filter_type = "PREFIX_MATCH"
          }
        ]
      }
    ]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `replication_configuration` (Attributes) The replication configuration for a registry. (see [below for nested schema](#nestedatt--replication_configuration))

### Read-Only

- `id` (String) Uniquely identifies the resource.
- `registry_id` (String)

<a id="nestedatt--replication_configuration"></a>
### Nested Schema for `replication_configuration`

Required:

- `rules` (Attributes List) An array of objects representing the replication destinations and repository filters for a replication configuration. (see [below for nested schema](#nestedatt--replication_configuration--rules))

<a id="nestedatt--replication_configuration--rules"></a>
### Nested Schema for `replication_configuration.rules`

Required:

- `destinations` (Attributes List) An array of objects representing the destination for a replication rule. (see [below for nested schema](#nestedatt--replication_configuration--rules--destinations))

Optional:

- `repository_filters` (Attributes List) An array of objects representing the filters for a replication rule. Specifying a repository filter for a replication rule provides a method for controlling which repositories in a private registry are replicated. (see [below for nested schema](#nestedatt--replication_configuration--rules--repository_filters))

<a id="nestedatt--replication_configuration--rules--destinations"></a>
### Nested Schema for `replication_configuration.rules.destinations`

Required:

- `region` (String) The Region to replicate to.
- `registry_id` (String) The AWS account ID of the Amazon ECR private registry to replicate to. When configuring cross-Region replication within your own registry, specify your own account ID.


<a id="nestedatt--replication_configuration--rules--repository_filters"></a>
### Nested Schema for `replication_configuration.rules.repository_filters`

Optional:

- `filter` (String) The repository filter details. When the ``PREFIX_MATCH`` filter type is specified, this value is required and should be the repository name prefix to configure replication for.
- `filter_type` (String) The repository filter type. The only supported value is ``PREFIX_MATCH``, which is a repository name prefix specified with the ``filter`` parameter.

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
$ terraform import awscc_ecr_replication_configuration.example "registry_id"
```
