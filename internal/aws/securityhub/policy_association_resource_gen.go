// Copyright (c) HashiCorp, Inc.
// SPDX-License-Identifier: MPL-2.0

// Code generated by generators/resource/main.go; DO NOT EDIT.

package securityhub

import (
	"context"
	"regexp"

	"github.com/hashicorp/terraform-plugin-framework-validators/stringvalidator"
	"github.com/hashicorp/terraform-plugin-framework/resource"
	"github.com/hashicorp/terraform-plugin-framework/resource/schema"
	"github.com/hashicorp/terraform-plugin-framework/resource/schema/planmodifier"
	"github.com/hashicorp/terraform-plugin-framework/resource/schema/stringplanmodifier"
	"github.com/hashicorp/terraform-plugin-framework/schema/validator"
	"github.com/hashicorp/terraform-provider-awscc/internal/generic"
	"github.com/hashicorp/terraform-provider-awscc/internal/identity"
	"github.com/hashicorp/terraform-provider-awscc/internal/registry"
)

func init() {
	registry.AddResourceFactory("awscc_securityhub_policy_association", policyAssociationResource)
}

// policyAssociationResource returns the Terraform awscc_securityhub_policy_association resource.
// This Terraform resource corresponds to the CloudFormation AWS::SecurityHub::PolicyAssociation resource.
func policyAssociationResource(ctx context.Context) (resource.Resource, error) {
	attributes := map[string]schema.Attribute{ /*START SCHEMA*/
		// Property: AssociationIdentifier
		// CloudFormation resource type schema:
		//
		//	{
		//	  "description": "A unique identifier to indicates if the target has an association",
		//	  "type": "string"
		//	}
		"association_identifier": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "A unique identifier to indicates if the target has an association",
			Computed:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: AssociationStatus
		// CloudFormation resource type schema:
		//
		//	{
		//	  "description": "The current status of the association between the specified target and the configuration",
		//	  "enum": [
		//	    "SUCCESS",
		//	    "PENDING",
		//	    "FAILED"
		//	  ],
		//	  "type": "string"
		//	}
		"association_status": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "The current status of the association between the specified target and the configuration",
			Computed:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: AssociationStatusMessage
		// CloudFormation resource type schema:
		//
		//	{
		//	  "description": "An explanation for a FAILED value for AssociationStatus",
		//	  "type": "string"
		//	}
		"association_status_message": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "An explanation for a FAILED value for AssociationStatus",
			Computed:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: AssociationType
		// CloudFormation resource type schema:
		//
		//	{
		//	  "description": "Indicates whether the association between the specified target and the configuration was directly applied by the Security Hub delegated administrator or inherited from a parent",
		//	  "enum": [
		//	    "APPLIED",
		//	    "INHERITED"
		//	  ],
		//	  "type": "string"
		//	}
		"association_type": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "Indicates whether the association between the specified target and the configuration was directly applied by the Security Hub delegated administrator or inherited from a parent",
			Computed:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: ConfigurationPolicyId
		// CloudFormation resource type schema:
		//
		//	{
		//	  "description": "The universally unique identifier (UUID) of the configuration policy or a value of SELF_MANAGED_SECURITY_HUB for a self-managed configuration",
		//	  "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$|^SELF_MANAGED_SECURITY_HUB$",
		//	  "type": "string"
		//	}
		"configuration_policy_id": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "The universally unique identifier (UUID) of the configuration policy or a value of SELF_MANAGED_SECURITY_HUB for a self-managed configuration",
			Required:    true,
			Validators: []validator.String{ /*START VALIDATORS*/
				stringvalidator.RegexMatches(regexp.MustCompile("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$|^SELF_MANAGED_SECURITY_HUB$"), ""),
			}, /*END VALIDATORS*/
		}, /*END ATTRIBUTE*/
		// Property: TargetId
		// CloudFormation resource type schema:
		//
		//	{
		//	  "description": "The identifier of the target account, organizational unit, or the root",
		//	  "type": "string"
		//	}
		"target_id": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "The identifier of the target account, organizational unit, or the root",
			Required:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.RequiresReplace(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: TargetType
		// CloudFormation resource type schema:
		//
		//	{
		//	  "description": "Indicates whether the target is an AWS account, organizational unit, or the organization root",
		//	  "enum": [
		//	    "ACCOUNT",
		//	    "ORGANIZATIONAL_UNIT",
		//	    "ROOT"
		//	  ],
		//	  "type": "string"
		//	}
		"target_type": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "Indicates whether the target is an AWS account, organizational unit, or the organization root",
			Required:    true,
			Validators: []validator.String{ /*START VALIDATORS*/
				stringvalidator.OneOf(
					"ACCOUNT",
					"ORGANIZATIONAL_UNIT",
					"ROOT",
				),
			}, /*END VALIDATORS*/
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.RequiresReplace(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: UpdatedAt
		// CloudFormation resource type schema:
		//
		//	{
		//	  "description": "The date and time, in UTC and ISO 8601 format, that the configuration policy association was last updated",
		//	  "type": "string"
		//	}
		"updated_at": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "The date and time, in UTC and ISO 8601 format, that the configuration policy association was last updated",
			Computed:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
	} /*END SCHEMA*/

	// Corresponds to CloudFormation primaryIdentifier.
	attributes["id"] = schema.StringAttribute{
		Description: "Uniquely identifies the resource.",
		Computed:    true,
		PlanModifiers: []planmodifier.String{
			stringplanmodifier.UseStateForUnknown(),
		},
	}

	schema := schema.Schema{
		Description: "The AWS::SecurityHub::PolicyAssociation resource represents the AWS Security Hub Central Configuration Policy associations in your Target. Only the AWS Security Hub delegated administrator can create the resouce from the home region.",
		Version:     1,
		Attributes:  attributes,
	}

	var opts generic.ResourceOptions

	opts = opts.WithCloudFormationTypeName("AWS::SecurityHub::PolicyAssociation").WithTerraformTypeName("awscc_securityhub_policy_association")
	opts = opts.WithTerraformSchema(schema)
	opts = opts.WithPrimaryIdentifier(
		identity.Identifier{
			Name:              "association_identifier",
			Description:       "A unique identifier to indicates if the target has an association",
			RequiredForImport: true,
		})

	opts = opts.WithAttributeNameMap(map[string]string{
		"association_identifier":     "AssociationIdentifier",
		"association_status":         "AssociationStatus",
		"association_status_message": "AssociationStatusMessage",
		"association_type":           "AssociationType",
		"configuration_policy_id":    "ConfigurationPolicyId",
		"target_id":                  "TargetId",
		"target_type":                "TargetType",
		"updated_at":                 "UpdatedAt",
	})

	opts = opts.WithCreateTimeoutInMinutes(1440).WithDeleteTimeoutInMinutes(0)

	opts = opts.WithUpdateTimeoutInMinutes(1440)

	v, err := generic.NewResource(ctx, opts...)

	if err != nil {
		return nil, err
	}

	return v, nil
}
